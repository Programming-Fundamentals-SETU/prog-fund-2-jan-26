# ProductTest

In this step, you will write new tests in ProductTest.java that will automate the testing of Product.java.

If we quickly look at our constructor and mutators for Product, we can see the following code:

~~~
    public Product(String productName, int productCode, double unitCost, boolean inCurrentProductLine) {
        this.productName = Utilities.truncateString(productName, 20);
        setProductCode(productCode);
        this.unitCost = unitCost;
        this.inCurrentProductLine = inCurrentProductLine;
    }

    public void setProductCode(int productCode) {
        if (Utilities.validRange(productCode, 1000, 9999)) {
            this.productCode = productCode;
        }
    }

    public void setProductName(String productName) {
        if (Utilities.validateStringLength(productName, 20)) {
            this.productName = productName;
        }
    }

    public void setUnitCost(double unitCost) {
        this.unitCost = unitCost;
    }

    public void setInCurrentProductLine(boolean inCurrentProductLine) {
        this.inCurrentProductLine = inCurrentProductLine;
    }

~~~

We can see that we have validation on productName (max 20 chars) and productCode (between 1000 and 9999 inclusive).

We are now going to test the constructors, getters and setters, taking this validation into consideration.


## Test Fixtures

The first thing we will do is to add test data (i.e. test fixtures).  Add four Product objects and instantiate them with:

- productNames  of 0, 19, 20 and 21 characters long (boundary test)
- productCodes of 999, 1000, 9999 and 10000
- unitCost of 0, 1, 999   (always aim to test for "nothing, one and many")
- inCurrentProductLine of true and false.

The code for this is here:

~~~
    private Product productBelow, productExact, productAbove, productZero;

    @BeforeEach
    void setUp() {
        //name, 19 chars, code 999, unitCost 1, inCurrentProductLine true.
        productBelow = new Product("Television 42Inches", 999, 1, true);
        //name, 20 chars, code 1000, unitCost 999, inCurrentProductLine true.
        productExact = new Product("Television 50 Inches", 1000, 999, true);
        //name, 21 chars, code 10000, unitCost 1000, inCurrentProductLine false.
        productAbove = new Product("Television 60 Inches.", 10000, 1000, false);
        //name, 0 chars, code 9999, unitCost 0, inCurrentProductLine false.
        productZero = new Product("", 9999, 0, false);
    }

    @AfterEach
    void tearDown() {
        productBelow = productExact = productAbove = productZero = null;
    }
~~~


## getProductName()

Refactor the *getProductName* method so that it looks like this:

~~~
    @Test
    void getProductName() {
        assertEquals("Television 42Inches", productBelow.getProductName());
        assertEquals("Television 50 Inches", productExact.getProductName());
        assertEquals("Television 60 Inches", productExact.getProductName());
        assertEquals("", productZero.getProductName());
    }
~~~

Now try run this method by clicking on the green arrow beside getProductName and selecting **Run getProductName**.  

![](./img/06.png) 

If you coded your method exactly the same as above, your test should fail:

![](./img/07.png)

Can you spot the error?  We had a typo above in the third assertEquals.  We should be testing productAbove and not productExact.  

Make this change now and run again...your test should pass:

![](./img/08.png)


## getUnitCost(), getProductCode(), isInCurrentProductLine()

Following the approach adopted above, code the test methods for the remaining three getters.  Make sure your tests all run with a green tick.


## Testing Setters

Now that we have successfully tested the getters, let's turn our attention to the setters.

Copy in the following method stubs into ProductTest:

~~~
    @Test
    void setProductName() {

    }

    @Test
    void setUnitCost() {

    }

    @Test
    void setProductCode() {

    }

    @Test
    void setInCurrentProductLine() {
        
    }
~~~

We will test the setProductName, like so:

~~~
    @Test
    void setProductName() {
        assertEquals("Television 42Inches", productBelow.getProductName());
        
        productBelow.setProductName("iPhone 13 Charcoal.");   //19 chars - update performed
        assertEquals("iPhone 13 Charcoal.", productBelow.getProductName());
        
        productBelow.setProductName("iPhone 12 - Charcoal");   //20 chars - update performed
        assertEquals("iPhone 12 - Charcoal", productBelow.getProductName());
        
        productBelow.setProductName("iPhone 11: - Charcoal");   //21 chars - update ignored
        assertEquals("iPhone 12 - Charcoal", productBelow.getProductName());
    }
~~~

Run this test...you should have green ticks. 

Using a similar approach, write code to test setUnitCost, setProductCode, setInCurrentProductLine. 


## Testing toString

Now we can move our attention to the toString test:

~~~
    @Test
    void testToString() {
        String toStringContents = productExact.toString();
        assertTrue(toStringContents.contains("Product description: " + productExact.getProductName()));
        assertTrue(toStringContents.contains("product code: " + productExact.getProductCode()));
        assertTrue(toStringContents.contains("unit cost: " + productExact.getUnitCost()));
        assertTrue(toStringContents.contains(" currently in product line: Y"));
    }
~~~

Try the above code and run ALL the tests in the test class.  You should hopefully have all green ticks for all 9 of them:

![](./img/09.png)


## Tidying up the test class

We can further tidy up our test classes by **grouping** like minded tests together into Nested classes e.g. all the setters, all the getters etc.  

To do this add the following code AROUND the four getter methods:

~~~
 @Nested
 class Getters {

    //getter methods go in here 
 
 }
~~~

And do the same for the four setter methods.

You will also need to import the @Nested class:

~~~
   import org.junit.jupiter.api.Nested;
~~~

Now run ALL the tests again and notice the difference in your output:

![](./img/10.png)


## Solution for ProductTest.java

- [ProductTest.java](archives/ProductTest.java)


