# StoreTest

In this part, you will create a test class for Store.java. 


## Creating StoreTest.java

*In this section, you may need to refer to your lecture slides for support (i.e. the fifth slide deck).*

Within your ShopV6.0 project, open Store.java.  Click above the **public class Store** declaration and when the light bulb appears, click on it and select **Create Test**.  Choose to generate the following CRUD methods:

![](./img/11.png) 

The following code will be generated:

![](./img/12.png) 


Update the above code with the following fixture data:

~~~
    private Product productBelow, productExact, productAbove, productZero;
    private Store storeWithProducts = new Store();
    private Store storeEmpty = new Store();

    @BeforeEach
    void setUp() {
        //name, 19 chars, code 999, unitCost 1, inCurrentProductLine true.
        productBelow = new Product("Television 42Inches", 999, 1, true);
        //name, 20 chars, code 1000, unitCost 999, inCurrentProductLine true.
        productExact = new Product("Television 50 Inches", 1000, 999, true);
        //name, 21 chars, code 10000, unitCost 1000, inCurrentProductLine false.
        productAbove = new Product("Television 60 Inches.", 10000, 1000, false);
        //name, 0 chars, code 9999, unitCost 0, inCurrentProductLine false.
        productZero = new Product("", 9999, 0, false);
        
        storeWithProducts.add(productBelow);
        storeWithProducts.add(productExact);
        storeWithProducts.add(productAbove);
        storeWithProducts.add(productZero);
    }

    @AfterEach
    void tearDown() {
        productBelow = productExact = productAbove = productZero = null;
        storeEmpty = storeWithProducts = null;
    }
~~~

## Refactoring the test method: add

Update the generated add method to this.  This test checks that we can add to an existing ArrayList that has products added already:

~~~
    @Test
    void addingToAnArrayListThatHasProductsIsSuccessful() {
        assertEquals(3, storeWithProducts.numberOfProducts());
        assertTrue(storeWithProducts.add(productZero));
        assertEquals(4, storeWithProducts.numberOfProducts());
        assertEquals(productZero, storeWithProducts.findProduct(3));
    }
~~~

Run the test; you should have a green tick. If not, return to the code to figure out where the issue is.

Now include a second method to test the add.  This test checks that we can add to an existing ArrayList that has NO products added already:

~~~
    @Test
    void addingToAnArrayListThatHasNoProductsIsSuccessful() {
        assertEquals(0, storeEmpty.numberOfProducts());
        assertTrue(storeEmpty.add(productZero));
        assertEquals(1, storeEmpty.numberOfProducts());
        assertEquals(productZero, storeEmpty.findProduct(0));
    }
~~~

Run the test; you should have a green tick. If not, return to the code to figure out where the issue is.


## Refactoring the test method: findProduct

Update the generated add method to this.  This test checks that we can find products in the ArrayList that have been added already.  Note how we are checking the indexes at the boundaries i.e. 0 and 2:

~~~
    @Test
    void findProductReturnsProductWhenIndexIsValid() {
        assertEquals(3, storeWithProducts.numberOfProducts());
        assertEquals(productBelow, storeWithProducts.findProduct(0));
        assertEquals(productAbove, storeWithProducts.findProduct(2));
    }
~~~

Run the test; you should have a green tick. If not, return to the code to figure out where the issue is.

Now include a second method to test the findProduct.  This test checks that we can the findProduct method can handle invalid indexes and doesn't crash our program:

~~~
    @Test
    void findProductReturnsNullWhenIndexIsInValid() {
        assertEquals(0, storeEmpty.numberOfProducts());
        assertNull(storeEmpty.findProduct(0));
        assertEquals(3, storeWithProducts.numberOfProducts());
        assertNull(storeWithProducts.findProduct(-1));
        assertNull(storeWithProducts.findProduct(3));
    }
~~~

Run the test; you should have a green tick. If not, return to the code to figure out where the issue is.


## Refactoring the test method: listProducts()

Update the generated listProducts method to this.  This test checks that the returned String contains all the products in the ArrayList:

~~~
    @Test
    void listProductsReturnsProductsWhenArrayListHasProductsStored() {
        assertEquals(3, storeWithProducts.numberOfProducts());
        String productsString = storeWithProducts.listProducts();
        assertTrue(productsString.contains("Television 42Inches"));
        assertTrue(productsString.contains("Television 50 Inches"));
        assertTrue(productsString.contains("Television 60 Inches"));
    }
~~~

Run the test; you should have a green tick. If not, return to the code to figure out where the issue is.

Now include a second method to test the listProducts.  This test checks that the returned String contains "no products" when the ArrayList is empty:

~~~
    @Test
    void listProductsReturnsNoProductsStoredWhenArrayListIsEmpty() {
        assertEquals(0, storeEmpty.numberOfProducts());
        assertTrue(storeEmpty.listProducts().toLowerCase().contains("no products"));
    }
~~~

Run the test; you should have a green tick. If not, return to the code to figure out where the issue is.


## Refactoring the test method: deleteProduct()

Update the generated deleteProduct method to this.  This test checks that product at the specified index is deleted:

~~~
    @Test
    void deletingAProductThatExistsDeletesAndReturnsDeletedObject(){
        assertEquals(3, storeWithProducts.numberOfProducts());
        assertEquals(productAbove, storeWithProducts.deleteProduct(2));
        assertEquals(2, storeWithProducts.numberOfProducts());
    }
~~~

Run the test; you should have a green tick. If not, return to the code to figure out where the issue is.

Now include a second method to test the deleteProduct.  This test checks that we can the deleteProduct method can handle invalid indexes and doesn't crash our program:

~~~
    @Test
    void deletingAProductThatDoesNotExistReturnsNull(){
        assertNull(storeEmpty.deleteProduct(0));
        assertNull(storeWithProducts.deleteProduct(-1));
        assertNull(storeWithProducts.deleteProduct(3));
    }
~~~

Run the test; you should have a green tick. If not, return to the code to figure out where the issue is.


## Refactoring the test method: updateProduct()

Update the generated updateProduct method to this.  This test checks that product at the specified index is updated:

~~~
    @Test
    void updatingANoteThatExistsReturnsTrueAndUpdates(){
        //check product index 2 exists and check the contents
        assertEquals(productAbove, storeWithProducts.findProduct(2));
        assertEquals("Television 60 Inches", storeWithProducts.findProduct(2).getProductName());
        assertEquals(-1, storeWithProducts.findProduct(2).getProductCode());
        assertEquals(1000, storeWithProducts.findProduct(2).getUnitCost());
        assertFalse(storeWithProducts.findProduct(2).isInCurrentProductLine());
  
        //update product 2 with new information and ensure contents updated successfully
        assertTrue(storeWithProducts.updateProduct(2, "Updating Product", 2000, 19.99, true));
        assertEquals("Updating Product", storeWithProducts.findProduct(2).getProductName());
        assertEquals(2000, storeWithProducts.findProduct(2).getProductCode());
        assertEquals(19.99, storeWithProducts.findProduct(2).getUnitCost());
        assertTrue(storeWithProducts.findProduct(2).isInCurrentProductLine());
    }

~~~

Run the test; you should have a green tick. If not, return to the code to figure out where the issue is.

Now include a second method to test the updateProduct.  This test checks that we can the updateProduct method can handle invalid indexes and doesn't crash our program:

~~~
    @Test
    void updatingAProductThatDoesNotExistReturnsFalse(){
        assertFalse(storeWithProducts.updateProduct(3, "Updating Product", 2, 19.99, false));
        assertFalse(storeWithProducts.updateProduct(-1, "Updating Product", 1002, 14.49, true));
        assertFalse(storeEmpty.updateProduct(0, "Updating Product", 1003, 199.99, false));
    }
~~~

Run the test; you should have a green tick. If not, return to the code to figure out where the issue is.


## Tidying up the test code

Now, run ALL tests in this test class.  Your output should look like this:

![](./img/13.png) 

Refactor, using Nested Classes (see previous step) so that your output looks like this:

![](./img/14.png) 


## Solution (so far) for StoreTest.java

- [StoreTest.java](archives/StoreTest.java)

